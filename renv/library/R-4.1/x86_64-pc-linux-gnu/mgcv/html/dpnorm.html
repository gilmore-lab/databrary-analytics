<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Stable evaluation of difference between normal c.d.f.s</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for dpnorm {mgcv}"><tr><td>dpnorm {mgcv}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Stable evaluation of difference between normal c.d.f.s</h2>

<h3>Description</h3>

<p>Evaluates the difference between two <i>N(0,1)</i> cumulative distribution functions avoiding cancellation error.  
</p>


<h3>Usage</h3>

<pre>
dpnorm(x0,x1)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x0</code></td>
<td>
<p>vector of lower values at which to evaluate standard normal distribution function.</p>
</td></tr>
<tr valign="top"><td><code>x1</code></td>
<td>
<p>vector of upper values at which to evaluate standard normal distribution function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Equivalent to <code>pnorm(x1)-pnorm(x0)</code>, but stable when <code>x0</code> and <code>x1</code> values are very close, or in the upper tail of the standard normal.</p>


<h3>Author(s)</h3>

<p> Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a></p>


<h3>Examples</h3>

<pre>
require(mgcv)
x &lt;- seq(-10,10,length=10000)
eps &lt;- 1e-10
y0 &lt;- pnorm(x+eps)-pnorm(x) ## cancellation prone
y1 &lt;- dpnorm(x,x+eps)       ## stable
## illustrate stable computation in black, and
## cancellation prone in red...
par(mfrow=c(1,2),mar=c(4,4,1,1))
plot(log(y1),log(y0),type="l")
lines(log(y1[x&gt;0]),log(y0[x&gt;0]),col=2)
plot(x,log(y1),type="l")
lines(x,log(y0),col=2)

</pre>

<hr /><div style="text-align: center;">[Package <em>mgcv</em> version 1.8-42 <a href="00Index.html">Index</a>]</div>
</body></html>
