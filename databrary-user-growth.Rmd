---
title: "databrary-user-growth"
author: "Andrea R. Seisler"
date: '`r Sys.time()`'
output:
  html_document:
    code_folding: show
    self_contained: no
    toc: yes
    toc_depth: 3
    toc_float: yes
  github_document: default
---
## Background

This document contains data and graphs related to Databrary institution and user growth.

## Load Libraries

```{r load-libraries}
#Load Libraries
library(ggplot2)
library(reshape2)
library(dplyr)
library(knitr)
library(cowplot)
```

## Import data

Here we import the data file found in `csv/institutionAuthCounts.csv`, include `YearMonth`, `Institutions`, and `Authorized Investigators` in dataframe (df).   

```{r import-data}
# Import data and clean

df <- read.csv(file = "csv/institutionAuthCounts.csv", header = TRUE)

# Remove extra characters from df$YearMonth
df$YearMonth <- as.Date(substr(df$YearMonth, 2, 11))
df$Year <- substr(df$YearMonth, 1, 4)
df$Month <- as.numeric(substr(df$YearMonth, 6, 7))
```

## Plot of User Growth

Here we plot all authorized Institutions and Investigators vs. date. I used https://www.hexcolortool.com to saturate the Databrary colors ("#fadbc7", "#b2ddd4") so they are darker on the graph.

```{r p-user-growth-plot, include=TRUE}

# Plot for all Institutions and Authorized Investigators vs. date

# the below code needs to be changed to geom_line

# Reshape df
df.melt <- melt(df, id = c("YearMonth", "Year", "Month"), value.name = "Count", variable.name = "Type")

# Using Points
p <- 
  ggplot(data=df.melt, aes(x = YearMonth, y = Count, color = Type, group = Type)) +
  geom_point() + 
  geom_line(size=3) +
  theme_classic(base_size = 14) +                        #Axis Label Size
  scale_colour_manual(values=c("#F49B85", "#4CAE99")) +  #Saturated Databrary Colors 
  ylab("Authorizations") +
  #xlab("Year") +
  #labs(title="Databrary User Growth") +
  theme(axis.title.x=element_blank()) +
  theme(legend.position="none", axis.text = element_text(size = rel(0.8), colour = "black")) +    #Axis text size and color
  theme(axis.line = element_blank()) +
  scale_y_continuous(breaks = seq(0, 700, 100)) +
  coord_cartesian()
 
  
ggdraw(p) + 
  draw_label("Investigators", .9, .8) +
  draw_label("Institutions", .9, .4)

```


